{
  "workspace_metadata": {
    "project_name": "Nucleo-H753ZI Project",
    "target_mcu": "STM32H753ZI",
    "architecture": "STM32H7 High Performance",
    "hal_version": "STM32H7xx_HAL_Driver V1.12.x",
    "rtos": "FreeRTOS V10.5.1",
    "build_system": "CMake + Ninja",
    "primary_abstraction": "HAL with custom abstraction layer",
    "analysis_date": "2025-08-21",
    "completeness_score": 0.92
  },
  "entry_points": {
    "main_entry": {
      "file": "Core/Src/main.c",
      "function": "main()",
      "description": "Primary application entry point",
      "sequence": [
        "HAL_Init()",
        "SystemClock_Config()",
        "MX_GPIO_Init()",
        "osKernelInitialize()",
        "MX_FREERTOS_Init()",
        "osKernelStart()"
      ]
    },
    "boot_entry": {
      "file": "startup_stm32h753xx.s",
      "function": "Reset_Handler",
      "description": "Hardware reset vector entry",
      "sequence": [
        "Stack pointer setup",
        "ExitRun0Mode()",
        "SystemInit()",
        "Data/BSS initialization",
        "libc_init_array()",
        "main()"
      ]
    }
  },
  "hal_ll_usage": {
    "primary_layer": "HAL",
    "ll_usage": "Minimal - HAL abstracts most operations",
    "key_patterns": [
      "__HAL_RCC_*_CLK_ENABLE()",
      "HAL_UART_Transmit()",
      "HAL_TIM_Base_Start_IT()",
      "HAL_GPIO_WritePin()",
      "HAL_NVIC_SetPriority()",
      "HAL_Delay()",
      "HAL_IncTick()"
    ],
    "custom_abstraction": {
      "layer": "src/hal_abstraction/",
      "purpose": "Cross-platform testing and hardware abstraction",
      "implementations": [
        "hal_abstraction_stm32h7.c (real hardware)",
        "hal_abstraction_mock.c (unit testing)"
      ]
    },
    "cmsis_shim_layer": {
      "purpose": "HAL to CMSIS driver abstraction for testing",
      "components": [
        "cmsis_uart_adapter.c - CMSIS abstraction layer",
        "driver_usart3_shim.c - HAL-to-CMSIS shim implementation"
      ],
      "usage": "Provides Driver_USART3 interface for CMSIS-compatible testing"
    }
  },
  "peripheral_initializations": {
    "gpio": {
      "function": "MX_GPIO_Init()",
      "file": "Core/Src/gpio.c",
      "clocks": ["GPIOC", "GPIOH"],
      "pins": "PC14-OSC32_IN, PC15-OSC32_OUT, PH0-OSC_IN, PH1-OSC_OUT"
    },
    "uart": {
      "drivers": [
        "cmsis_uart_adapter.c (CMSIS abstraction)",
        "driver_usart3_shim.c (HAL shim)"
      ],
      "instances": ["USART3"],
      "features": ["DMA support", "Interrupt handling"]
    },
    "timers": {
      "instances": ["TIM2 (Control Loop)", "TIM3 (Safety Monitor)", "TIM6 (SysTick)"],
      "handlers": ["rt_control_loop_handler()", "rt_safety_monitor_handler()"]
    }
  },
  "interrupt_vectors": {
    "file": "startup_stm32h753xx.s",
    "total_vectors": 150,
    "active_handlers": [
      "TIM2_IRQHandler -> TIM2",
      "TIM3_IRQHandler -> TIM3",
      "TIM6_DAC_IRQHandler -> TIM6",
      "SysTick_Handler -> SysTick",
      "PendSV_Handler -> FreeRTOS",
      "SVC_Handler -> FreeRTOS"
    ],
    "default_handlers": 144,
    "custom_handlers": 6
  },
  "rtos_integration": {
    "framework": "FreeRTOS V10.5.1",
    "tasks": [
      "motor_control_task.c",
      "safety_monitor_task.c",
      "communication_tasks.c"
    ],
    "integration_file": "Core/Src/freertos.c",
    "config_file": "Core/Inc/FreeRTOSConfig.h"
  },
  "module_dependencies": {
    "core_modules": [
      {"name": "telemetry", "deps": ["hal_abstraction", "rtos"]},
      {"name": "motor_control", "deps": ["telemetry", "safety", "rtos"]},
      {"name": "safety", "deps": ["hal_abstraction", "rtos"]},
      {"name": "communication", "deps": ["drivers", "rtos"]}
    ],
    "driver_modules": [
      {"name": "adaptation", "purpose": "HAL to CMSIS abstraction"},
      {"name": "as5600", "purpose": "Encoder driver"},
      {"name": "l6470", "purpose": "Motor driver"}
    ]
  },
  "key_functions": {
    "clock_config": {
      "function": "SystemClock_Config()",
      "file": "Core/Src/main.c",
      "description": "HSI 64MHz configuration",
      "registers": ["RCC_OSCInitStruct", "RCC_ClkInitStruct"]
    },
    "peripheral_setups": [
      {"type": "GPIO", "function": "MX_GPIO_Init()", "file": "Core/Src/gpio.c"},
      {"type": "UART", "function": "cmsis_uart_init()", "file": "src/drivers/adaptation/cmsis_uart_adapter.c"},
      {"type": "Timer", "function": "HAL_TIM_Base_Start_IT()", "file": "Various"}
    ],
    "isr_routines": [
      {"name": "rt_control_loop_handler()", "timer": "TIM2", "frequency": "1kHz"},
      {"name": "rt_safety_monitor_handler()", "timer": "TIM3", "frequency": "500Hz"},
      {"name": "HAL_TIM_PeriodElapsedCallback()", "purpose": "SysTick increment"}
    ]
  },
  "semantic_anchors": {
    "entry_points": ["main()", "Reset_Handler", "SystemInit()"],
    "critical_functions": ["SystemClock_Config()", "rt_control_loop_handler()", "rt_safety_monitor_handler()"],
    "safety_functions": ["emergency_stop()", "safety_monitor_task()"],
    "communication_functions": ["cmsis_uart_send()", "cmsis_uart_init()"],
    "motor_functions": ["motor_control_task()", "motor_characterization()"]
  },
  "traceability_analysis": {
    "startup_sequence": {
      "completeness": "COMPLETE",
      "traceable_elements": 8,
      "missing_elements": 0
    },
    "peripheral_linkage": {
      "completeness": "HIGH",
      "active_peripherals": 6,
      "documented_handlers": 6,
      "default_handlers": 144
    },
    "hal_version_compatibility": {
      "status": "COMPATIBLE",
      "version": "V1.12.x",
      "rtos_constraint": "RESOLVED"
    }
  },
  "gaps_identified": {
    "stubs": [
      "Default_Handler (144 instances) - expected for unused interrupts"
    ],
    "undocumented": [
      "Some peripheral configurations missing detailed comments",
      "Custom handler implementations could have more documentation"
    ],
    "unused_includes": [
      "Potential cleanup opportunity in some header files"
    ],
    "dead_code": [
      "None identified - codebase appears actively maintained"
    ]
  },
  "suggested_improvements": {
    "documentation": [
      "Add detailed comments to peripheral configurations",
      "Document custom handler implementations"
    ],
    "architecture": [
      "Consider consolidating UART drivers into single abstraction layer",
      "Review interrupt priority assignments for optimization"
    ],
    "testing": [
      "Add integration tests for interrupt handling",
      "Expand coverage for peripheral initialization sequences"
    ]
  }
}
